/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t,o={2787:(e,t,o)=>{"use strict";o.d(t,{$B:()=>u,AR:()=>b,Af:()=>m,Du:()=>g,Ek:()=>k,FK:()=>E,G5:()=>V,GU:()=>M,GW:()=>_,Lh:()=>T,N4:()=>a,NZ:()=>j,OF:()=>h,OU:()=>$,SW:()=>n,Vr:()=>I,WD:()=>l,Z8:()=>f,ab:()=>s,bC:()=>v,cd:()=>x,eH:()=>p,fU:()=>A,kP:()=>r,nH:()=>d,oO:()=>C,oS:()=>D,os:()=>y,x2:()=>i,yF:()=>S,yw:()=>N,zs:()=>w,zy:()=>c});const i="session_view",s="1",n="/internal/session_view/process_events",r="/internal/session_view/alerts",l="/internal/session_view/alert_status",a="/internal/session_view/io_events",d="/internal/session_view/get_total_io_bytes",u="security",c="/administration/policy",p="process.entry_leader.entity_id",m=500,x=100,v=10,g="sessionViewProcessEvents",j="sessionViewAlerts",b="sessionViewIOEvents",h="sessionViewGetTotalIOBytes",y="sessionView:displayOptions",f={stopPropagation:()=>{}},C=500,T=30,w=200,S=11,k=66,_=280,I=/(\r?\n|\r\n?|\x1b\[\d+;\d*[Hf]?)/gi,E=999,$={process:"gear",file:"document",network:"globe"},N="all",P=["@timestamp","event.id","event.kind","event.type","event.action","event.category","user.id","user.name","group.id","group.name","host.architecture","host.hostname","host.id","host.ip","host.mac","host.name","host.os.family","host.os.full","host.os.kernel","host.os.name","host.platform","host.version","host.boot.id","process.entity_id","process.args","process.command_line","process.executable","process.name","process.interactive","process.working_directory","process.pid","process.start","process.end","process.user.id","process.user.name","process.group.id","process.group.name","process.supplemental_groups","process.exit_code","process.tty.*","process.entry_leader.*","process.session_leader.*","process.group_leader.*","process.parent.*","process.previous","container.id","container.name","container.image.name","container.image.tag","container.image.hash.all","orchestrator.resource.name","orchestrator.resource.type","orchestrator.resource.ip","orchestrator.resource.parent.type","orchestrator.resource.labels","orchestrator.resource.annotations","orchestrator.namespace","orchestrator.cluster.name","orchestrator.cluster.id","cloud.instance.name","cloud.account.id","cloud.project.id","cloud.project.name","cloud.provider","cloud.region"],A=(P.concat(["process.io.*"]),P.concat(["file.extension","file.path","file.name","network.type","network.transport","network.protocol","destination.address","destination.ip","destination.protocol","source.address","source.ip","source.protocol","kibana.alert.uuid","kibana.alert.reason","kibana.alert.workflow_status","kibana.alert.status","kibana.alert.original_time","kibana.alert.original_event.action","kibana.alert.rule.category","kibana.alert.rule.consumer","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.name","kibana.alert.rule.risk_score","kibana.alert.rule.severity","kibana.alert.rule.uuid","kibana.alert.rule.parameters.query","kibana.alert.rule.query"]),"fork"),M="end",V="exec",D="executed"},1716:(e,t,o)=>{"use strict";o.d(t,{U:()=>l});var i=o(5008);const s=i.i18n.translate("xpack.sessionView.processTooltip",{defaultMessage:"Process alert"}),n=i.i18n.translate("xpack.sessionView.networkTooltip",{defaultMessage:"Network alert"}),r=i.i18n.translate("xpack.sessionView.fileTooltip",{defaultMessage:"File alert"}),l=e=>{let t="";switch(e){case"file":t=r;break;case"network":t=n;break;default:t=s}return t}},9235:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});var i=o(4286),s=o(1319),n=o(4916),r=o(6791);const l=({id:e,listItems:t,title:o,tooltipContent:l,extraActionTitle:a,onExtraActionClick:d,children:u,initialIsOpen:c=!1})=>{const p=(()=>{const{euiTheme:e}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>{const t={padding:e.size.base};return{accordion:{borderTop:e.border.thin,"&:last-child":{borderBottom:e.border.thin},dl:{paddingTop:"0px"},"&:only-child":{border:e.border.thin,borderRadius:e.border.radius.medium}},accordionButton:{padding:e.size.base,fontWeight:e.font.weight.bold},tabSection:t}}),[e])})();return(0,r.jsx)(s.EuiAccordion,{id:e,arrowDisplay:"right",initialIsOpen:c,buttonContent:(0,r.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,css:p.accordionButton},(0,r.jsx)(s.EuiFlexItem,{grow:!1},(0,r.jsx)("span",null,o)),l&&(0,r.jsx)(s.EuiFlexItem,{grow:!1,"data-test-subj":"sessionView:detail-panel-accordion-tooltip"},(0,r.jsx)(s.EuiIconTip,{content:l}))),css:p.accordion,"data-test-subj":"sessionView:detail-panel-accordion"},(0,r.jsx)(n.E,{listItems:t}),u)}},190:(e,t,o)=>{"use strict";o.d(t,{B7:()=>f});var i=o(4286),s=o(1319),n=o(5008),r=o(5879),l=o(770),a=o(1716),d=o(2787),u=o(6791);const c=(e=!1,t=!1)=>{const{euiTheme:o}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>{const{colors:i,font:n,size:r,border:l}=o,a=(0,s.transparentize)(i.danger,.2),d=(0,s.transparentize)(i.danger,.08),c=l.width.thin,p=r.m;let m=i.text,x=i.lightShade;t&&(m=i.primaryText,x=a);const v=(0,u.css)("border:",c," solid ",x,";padding:",p,";border-radius:",l.radius.medium,";margin:0 ",p," ",p," ",p,";background-color:",i.emptyShade,";& .euiAccordion__buttonContent{width:100%;}& .euiAccordion__button{min-width:0;width:calc(100% - ",r.l,");}& .euiAccordion__childWrapper{overflow:visible;}","");return{alertItem:v,alertGroupItem:(0,u.css)(v," & .euiAccordion__childWrapper{overflow:hidden;}",""),alertTitleContainer:{display:e?"none":"initial",color:m,fontWeight:n.weight.semiBold},alertTitle:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},alertIcon:{marginRight:r.s},alertAccordionButton:{width:`calc(100% - ${r.l})`,minWidth:0},alertCountArrowPad:{marginRight:r.xs},processPanel:{border:`${c} solid ${i.lightShade}`,fontFamily:n.familyCode,marginTop:e?r.s:r.m,padding:`${r.xs} ${r.s}`},investigatedLabel:{position:"relative",zIndex:1,bottom:`-${p}`,left:`-${p}`,width:`calc(100% + ${p} * 2)`,borderTop:`${c} solid ${a}`,borderBottomLeftRadius:l.radius.medium,borderBottomRightRadius:l.radius.medium,backgroundColor:d,textAlign:"center"},minimalContextMenu:{float:"right"},firstAlertPad:{"&:first-child":{paddingTop:r.base}},minimalHR:{marginBottom:0}}}),[o,t,e])},p=({event:e,onShowAlertDetails:t,onJumpToEvent:o})=>{var l,a,d;const[c,p]=(0,i.useState)(!1),m=(0,i.useCallback)((()=>{p(!1)}),[]),x=(0,i.useCallback)((()=>{p(!c)}),[c]),v=(0,i.useCallback)((()=>{o(e),p(!1)}),[e,o]),g=(0,i.useCallback)((()=>{var o,i;null!==(o=e.kibana)&&void 0!==o&&null!==(i=o.alert)&&void 0!==i&&i.uuid&&(t(e.kibana.alert.uuid),p(!1))}),[e,t]);if(!e.kibana)return null;const j=null!==(l=null===(a=e.kibana)||void 0===a||null===(d=a.alert)||void 0===d?void 0:d.uuid)&&void 0!==l?l:"",b=[(0,u.jsx)(s.EuiContextMenuItem,{key:"details","data-test-subj":"sessionView:detailPanelAlertActionShowDetails",onClick:g},(0,u.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.showDetailsAction",defaultMessage:"View alert details"})),(0,u.jsx)(s.EuiContextMenuItem,{key:"jumpTo","data-test-subj":"sessionView:detailPanelAlertActionJumpToProcess",onClick:v},(0,u.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.jumpToAlert",defaultMessage:"Jump to alerted process"}))];return(0,u.jsx)(s.EuiPopover,{id:j,button:(0,u.jsx)(s.EuiButtonIcon,{display:"empty",size:"s",iconType:"boxesHorizontal","aria-label":n.i18n.translate("xpack.sessionView.detailPanelAlertListItem.moreButton",{defaultMessage:"More"}),"data-test-subj":"sessionView:detailPanelAlertActionsBtn",onClick:x}),isOpen:c,closePopover:m,panelPaddingSize:"none",anchorPosition:"leftCenter"},(0,u.jsx)(s.EuiContextMenuPanel,{size:"s",items:b}))};var m=o(6559),x=o(9678),v=o(8392);const g="sessionView:detailPanelAlertListItem",j="sessionView:detailPanelAlertListItemArgs",b=({event:e,onJumpToEvent:t,onShowAlertDetails:o,isInvestigated:i,minimal:n})=>{var l,b,h,y;const f=c(n,i),C=(0,x.N)();if(!e.kibana)return null;const T=(0,s.formatDate)(e["@timestamp"],C),w=null===(l=e.kibana)||void 0===l||null===(b=l.alert)||void 0===b?void 0:b.rule,S=(null==w?void 0:w.uuid)||"",k=(null==w?void 0:w.name)||"",{args:_,name:I}=null!==(h=e.process)&&void 0!==h?h:{},{event:E}=e,$=i?void 0:"open",N=Array.isArray(null==E?void 0:E.category)?null==E||null===(y=E.category)||void 0===y?void 0:y[0]:null==E?void 0:E.category,P=null!=N?N:"process",A="process"!==N?`${(0,m.I)(I)} ${(0,v.c)(e,N)}`:(0,m.I)(null==_?void 0:_.join(" ")),M=(0,a.U)(P);return n?(0,u.jsx)("div",{"data-test-subj":g,css:f.firstAlertPad},(0,u.jsx)(s.EuiSpacer,{size:"xs"}),(0,u.jsx)(s.EuiFlexGroup,{alignItems:"center"},(0,u.jsx)(s.EuiFlexItem,null,(0,u.jsx)(s.EuiText,{color:"subdued",size:"s"},(0,m.I)(T))),(0,u.jsx)(s.EuiFlexItem,{grow:!1},(0,u.jsx)(p,{css:f.minimalContextMenu,event:e,onJumpToEvent:t,onShowAlertDetails:o}))),(0,u.jsx)(s.EuiPanel,{css:f.processPanel,color:"subdued",hasBorder:!0,hasShadow:!1,borderRadius:"m"},(0,u.jsx)(s.EuiText,{"data-test-subj":j,size:"xs"},A)),(0,u.jsx)(s.EuiHorizontalRule,{css:f.minimalHR,margin:"m",size:"full"})):(0,u.jsx)(s.EuiAccordion,{id:S,"data-test-subj":g,arrowDisplay:i?"right":"none",buttonContent:(0,u.jsx)(s.EuiText,{css:f.alertTitleContainer,size:"s"},(0,u.jsx)("p",{css:f.alertTitle},(0,u.jsx)(s.EuiToolTip,{position:"top",content:M},(0,u.jsx)(s.EuiIcon,{color:"danger",type:d.OU[P],css:f.alertIcon})),(0,m.I)(k))),initialIsOpen:!0,forceState:$,css:f.alertItem,extraAction:(0,u.jsx)(p,{event:e,onJumpToEvent:t,onShowAlertDetails:o})},(0,u.jsx)(s.EuiSpacer,{size:"xs"}),(0,u.jsx)(s.EuiText,{"data-test-subj":"sessionView:detailPanelAlertListItemTimestamp",color:"subdued",size:"s"},(0,m.I)(T)),(0,u.jsx)(s.EuiPanel,{css:f.processPanel,color:"subdued",hasBorder:!0,hasShadow:!1,borderRadius:"m"},(0,u.jsx)(s.EuiText,{"data-test-subj":j,size:"xs"},A)),i&&(0,u.jsx)("div",{css:f.investigatedLabel},(0,u.jsx)(s.EuiText,{size:"xs",color:"danger"},(0,u.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.investigatedLabel",defaultMessage:"Investigated alert"}))))},h=({alerts:e,onJumpToEvent:t,onShowAlertDetails:o})=>{var i,n,r,l;const a=c(),d=e.length.toLocaleString();if(!e[0].kibana)return null;const{rule:p}=null!==(i=null===(n=e[0])||void 0===n||null===(r=n.kibana)||void 0===r?void 0:r.alert)&&void 0!==i?i:{};return(0,u.jsx)(s.EuiAccordion,{id:null!==(l=null==p?void 0:p.uuid)&&void 0!==l?l:"","data-test-subj":"sessionView:detailPanelAlertGroupItem",arrowDisplay:"right",initialIsOpen:!1,buttonContent:(0,u.jsx)(s.EuiText,{"data-test-subj":"sessionView:detailPanelAlertGroupTitle",css:a.alertTitleContainer,size:"s"},(0,u.jsx)("p",{css:a.alertTitle},(0,u.jsx)(s.EuiIcon,{color:"danger",type:"warning",css:a.alertIcon}),(0,m.I)(null==p?void 0:p.name))),css:a.alertGroupItem,extraAction:(0,u.jsx)(s.EuiNotificationBadge,{"data-test-subj":"sessionView:detailPanelAlertGroupCount",className:"eui-alignCenter",size:"m",css:a.alertCountArrowPad},d)},e.map((e=>{var i,s;const n="minimal_"+(null===(i=e.kibana)||void 0===i||null===(s=i.alert)||void 0===s?void 0:s.uuid);return(0,u.jsx)(b,{key:n,minimal:!0,event:e,onJumpToEvent:t,onShowAlertDetails:o})})))},y="listView",f=({alerts:e,isFetchingAlerts:t,hasNextPageAlerts:o,fetchNextPageAlerts:a,onJumpToEvent:d,onShowAlertDetails:c,investigatedAlertId:p})=>{const m=(()=>{const{euiTheme:e}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>{const{colors:t,size:o}=e;return{container:{position:"relative"},stickyItem:{position:"sticky",top:0,zIndex:1,backgroundColor:t.emptyShade},viewMode:{margin:o.base},loadMoreBtn:{margin:o.m,width:`calc(100% - ${o.m} * 2)`}}}),[e])})(),[x,v]=(0,i.useState)(y),g=[{id:y,label:n.i18n.translate("xpack.sessionView.alertDetailsTab.listView",{defaultMessage:"List view"})},{id:"groupView",label:n.i18n.translate("xpack.sessionView.alertDetailsTab.groupView",{defaultMessage:"Group view"})}],j=(0,i.useMemo)((()=>p&&e.find((e=>{var t,o;return(null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o?void 0:o.uuid)===p}))),[p,e]),f=(0,i.useMemo)((()=>(0,l.groupBy)(e,(e=>{var t,o,i;return null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o||null===(i=o.rule)||void 0===i?void 0:i.uuid}))),[e]);return 0===e.length?(0,u.jsx)(s.EuiEmptyPrompt,{"data-test-subj":"sessionView:detailPanelAlertsEmptyState",title:(0,u.jsx)("h2",null,(0,u.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertsEmptyTitle",defaultMessage:"No alerts"})),body:(0,u.jsx)("p",null,(0,u.jsx)(r.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertsEmptyMsg",defaultMessage:"No alerts were created for this session."}))}):(0,u.jsx)("div",{css:m.container},(0,u.jsx)(s.EuiButtonGroup,{"data-test-subj":"sessionView:detailPanelAlertsViewMode",css:m.viewMode,legend:n.i18n.translate("xpack.sessionView.alertDetailsTab.toggleViewMode",{defaultMessage:"Toggle view mode"}),options:g,idSelected:x,onChange:v,buttonSize:"compressed",isFullWidth:!0}),j&&(0,u.jsx)("div",{css:m.stickyItem,"data-test-subj":"sessionView:detailPanelInvestigatedAlert"},(0,u.jsx)(b,{event:j,onJumpToEvent:d,onShowAlertDetails:c,isInvestigated:!0}),(0,u.jsx)(s.EuiHorizontalRule,{margin:"m",size:"full"})),x===y?e.map((e=>{var t,o;const i=null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o?void 0:o.uuid;if(i&&e!==j)return(0,u.jsx)(b,{key:i,event:e,onJumpToEvent:d,onShowAlertDetails:c})})):Object.keys(f).map((e=>{var t,o,i;const s=f[e],n=null===(t=s[0].kibana)||void 0===t||null===(o=t.alert)||void 0===o||null===(i=o.rule)||void 0===i?void 0:i.uuid;if(n)return(0,u.jsx)(h,{key:n,alerts:s,onJumpToEvent:d,onShowAlertDetails:c})})),o&&(0,u.jsx)(s.EuiButton,{color:"primary",isLoading:t,onClick:a,css:m.loadMoreBtn,"data-test-subj":"alerts-details-load-more"},(0,u.jsx)(r.FormattedMessage,{id:"xpack.sessionView.alertsLoadMoreButton",defaultMessage:"Load more alerts"})))}},6330:(e,t,o)=>{"use strict";o.d(t,{f:()=>d});var i=o(4286),s=o.n(i),n=o(1319),r=o(5008),l=o(6275),a=o(6791);const d=({children:e,textToCopy:t,tooltipContent:o,display:d="inlineBlock"})=>{const u=(()=>{const{euiTheme:e}=(0,n.useEuiTheme)();return(0,i.useMemo)((()=>({copyButton:{position:"absolute",right:e.size.s,top:0,bottom:0,margin:"auto"}})),[e])})(),c={copy:(0,a.jsx)(n.EuiCopy,{textToCopy:t,display:d},(e=>(0,a.jsx)(n.EuiButtonIcon,{css:u.copyButton,onClick:e,display:"base",iconType:"copyClipboard",size:"xs","aria-label":r.i18n.translate("xpack.sessionView.detailPanelCopy.copyButton",{defaultMessage:"Copy"})})))};return"block"===d&&(c.display=d),(0,a.jsx)(l.N,c,(0,a.jsx)(n.EuiToolTip,{position:"top",content:o},(0,a.jsx)(s().Fragment,null,e)))}},4916:(e,t,o)=>{"use strict";o.d(t,{E:()=>r});var i=o(4286),s=o(1319),n=o(6791);const r=({listItems:e})=>{const t=(()=>{const{euiTheme:e}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>({descriptionList:{padding:`${e.size.base} ${e.size.s} `,alignItems:"flex-start",rowGap:0},tabListTitle:{display:"flex"},tabListDescription:{display:"flex"}})),[e])})();return(0,n.jsx)(s.EuiDescriptionList,{type:"column",columnWidths:[2,3],listItems:e,css:t.descriptionList,titleProps:{css:t.tabListTitle},descriptionProps:{css:t.tabListDescription},"data-test-subj":"sessionView:detail-panel-description-list"})}},6275:(e,t,o)=>{"use strict";o.d(t,{N:()=>l});var i=o(3185),s=o(4286),n=o(1319),r=o(6791);const l=({children:e,copy:t,display:o="grid"})=>{const[l,a]=(0,s.useState)(!1),d=(({display:e})=>{const{euiTheme:t}=(0,n.useEuiTheme)();return(0,s.useMemo)((()=>{const o={display:e,alignContent:"center",padding:`${t.size.xs} ${t.size.s} `,width:"100%",fontWeight:"inherit",height:"max-content",minHeight:t.size.l,letterSpacing:"0px",textAlign:"left","& .euiToolTipAnchor":{width:`calc(100% - ${t.size.xl})`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}};return{item:o,copiableItem:{...o,position:"relative",borderRadius:t.border.radius.medium,"&:hover":{background:(0,n.transparentize)(t.colors.primary,.1)},height:"fit-content"}}}),[e,t])})({display:o}),u={size:"s",css:t?d.copiableItem:d.item};return t&&(u.onMouseEnter=()=>a(!0),u.onMouseLeave=()=>a(!1)),(0,r.jsx)(n.EuiText,(0,i.default)({},u,{"data-test-subj":"sessionView:detail-panel-list-item"}),e,l&&t)}},1544:(e,t,o)=>{"use strict";o.d(t,{W:()=>x});var i=o(4286),s=o.n(i),n=o(1319),r=o(5008),l=o(9235),a=o(6330),d=o(6275),u=o(8202),c=o(4023),p=o(6559),m=o(6791);const x=({processHost:e,processContainer:t,processOrchestrator:o,processCloud:x})=>{const v=(0,u.I)(),g=(()=>{const{euiTheme:e}=(0,n.useEuiTheme)();return(0,i.useMemo)((()=>({metadataHostOS:{margin:`${e.size.m} ${e.size.base} ${e.size.base} ${e.size.base}`,paddingBottom:e.size.base}})),[e])})(),j=(0,i.useMemo)((()=>(e=>{var t,o,i,s,n,r,l,a,d,u,m,x;const v={architecture:c.j,hostname:c.j,id:c.j,ip:c.j,mac:c.j,name:c.j,os:{family:c.j,full:c.j,kernel:c.j,name:c.j,platform:c.j,version:c.j}};return e?(v.hostname=(0,p.I)(e.hostname).toString(),v.id=(0,p.I)(e.id).toString(),v.ip=null!==(t=null===(o=e.ip)||void 0===o||null===(i=o.map)||void 0===i?void 0:i.call(o,(e=>(0,p.I)(e))).join(", "))&&void 0!==t?t:c.j,v.mac=null!==(s=null===(n=e.mac)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(e=>(0,p.I)(e))).join(", "))&&void 0!==s?s:c.j,v.name=(0,p.I)(e.name).toString(),v.architecture=(0,p.I)(e.architecture).toString(),v.os.family=(0,p.I)(null===(l=e.os)||void 0===l?void 0:l.family).toString(),v.os.full=(0,p.I)(null===(a=e.os)||void 0===a?void 0:a.full).toString(),v.os.kernel=(0,p.I)(null===(d=e.os)||void 0===d?void 0:d.kernel).toString(),v.os.name=(0,p.I)(null===(u=e.os)||void 0===u?void 0:u.name).toString(),v.os.platform=(0,p.I)(null===(m=e.os)||void 0===m?void 0:m.platform).toString(),v.os.version=(0,p.I)(null===(x=e.os)||void 0===x?void 0:x.version).toString(),v):v})(e)),[e]),b=(0,i.useMemo)((()=>(e=>{var t,o,i,s;const n={id:c.j,name:c.j,image:{name:c.j,tag:c.j,hash:{all:c.j}}};return e?(n.id=(0,p.I)(e.id).toString(),n.name=(0,p.I)(e.name).toString(),n.image.name=(0,p.I)(null==e||null===(t=e.image)||void 0===t?void 0:t.name).toString(),n.image.tag=(0,p.I)(null==e||null===(o=e.image)||void 0===o?void 0:o.tag).toString(),n.image.hash.all=(0,p.I)(null==e||null===(i=e.image)||void 0===i||null===(s=i.hash)||void 0===s?void 0:s.all).toString(),n):n})(t)),[t]),h=(0,i.useMemo)((()=>(e=>{var t,o,i,s,n,r,l;const a={resource:{name:c.j,type:c.j,ip:c.j,parent:{type:c.j}},namespace:c.j,cluster:{name:c.j,id:c.j}};return e?(a.resource.name=(0,p.I)(null==e||null===(t=e.resource)||void 0===t?void 0:t.name).toString(),a.resource.type=(0,p.I)(null==e||null===(o=e.resource)||void 0===o?void 0:o.type).toString(),a.resource.ip=(0,p.I)(null==e||null===(i=e.resource)||void 0===i?void 0:i.ip).toString(),a.namespace=(0,p.I)(null==e?void 0:e.namespace).toString(),a.cluster.name=(0,p.I)(null==e||null===(s=e.cluster)||void 0===s?void 0:s.name).toString(),a.cluster.id=(0,p.I)(null==e||null===(n=e.cluster)||void 0===n?void 0:n.id).toString(),a.resource.parent.type=(0,p.I)(null==e||null===(r=e.resource)||void 0===r||null===(l=r.parent)||void 0===l?void 0:l.type).toString(),a):a})(o)),[o]),y=(0,i.useMemo)((()=>(e=>{var t,o,i,s;const n={instance:{name:c.j},account:{id:c.j},project:{id:c.j,name:c.j},provider:c.j,region:c.j};return e?(n.instance.name=(0,p.I)(null==e||null===(t=e.instance)||void 0===t?void 0:t.name).toString(),n.account.id=(0,p.I)(null==e||null===(o=e.account)||void 0===o?void 0:o.id).toString(),n.project.id=(0,p.I)(null==e||null===(i=e.project)||void 0===i?void 0:i.id).toString(),n.project.name=(0,p.I)(null==e||null===(s=e.project)||void 0===s?void 0:s.name).toString(),n.provider=(0,p.I)(null==e?void 0:e.provider).toString(),n.region=(0,p.I)(null==e?void 0:e.region).toString(),n):n})(x)),[x]);return(0,m.jsx)(s().Fragment,null,(0,m.jsx)(l.A,{id:"metadataHost",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.metadataHost",{defaultMessage:"Host"}),initialIsOpen:!0,listItems:[{title:(0,m.jsx)(d.N,null,"id"),description:(0,m.jsx)(a.f,{textToCopy:`host.id: "${j.id}"`,tooltipContent:j.id},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.id))},{title:(0,m.jsx)(d.N,null,"hostname"),description:(0,m.jsx)(a.f,{textToCopy:`host.hostname: "${j.hostname}"`,tooltipContent:j.hostname},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.hostname))},{title:(0,m.jsx)(d.N,null,"ip"),description:(0,m.jsx)(a.f,{textToCopy:`host.ip: "${j.ip}"`,tooltipContent:j.ip},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.ip))},{title:(0,m.jsx)(d.N,null,"mac"),description:(0,m.jsx)(a.f,{textToCopy:`host.mac: "${j.mac}"`,tooltipContent:j.mac},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.mac))},{title:(0,m.jsx)(d.N,null,"name"),description:(0,m.jsx)(a.f,{textToCopy:`host.name: "${j.name}"`,tooltipContent:j.name},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.name))}]},(0,m.jsx)(n.EuiPanel,{hasShadow:!1,color:"plain",hasBorder:!1,borderRadius:"m",paddingSize:"none",css:g.metadataHostOS},(0,m.jsx)(l.A,{id:"hostOS",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.host",{defaultMessage:"OS"}),listItems:[{title:(0,m.jsx)(d.N,null,"architecture"),description:(0,m.jsx)(a.f,{textToCopy:`host.architecture: "${j.architecture}"`,tooltipContent:j.architecture},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.architecture))},{title:(0,m.jsx)(d.N,null,"os.family"),description:(0,m.jsx)(a.f,{textToCopy:`host.os.family: "${j.os.family}"`,tooltipContent:j.os.family},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.os.family))},{title:(0,m.jsx)(d.N,null,"os.full"),description:(0,m.jsx)(a.f,{textToCopy:`host.os.full: "${j.os.full}"`,tooltipContent:j.os.full},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.os.full))},{title:(0,m.jsx)(d.N,null,"os.kernel"),description:(0,m.jsx)(a.f,{textToCopy:`host.os.kernel: "${j.os.kernel}"`,tooltipContent:j.os.kernel},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.os.kernel))},{title:(0,m.jsx)(d.N,null,"os.name"),description:(0,m.jsx)(a.f,{textToCopy:`host.os.name: "${j.os.name}"`,tooltipContent:j.os.name},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.os.name))},{title:(0,m.jsx)(d.N,null,"os.platform"),description:(0,m.jsx)(a.f,{textToCopy:`host.os.platform: "${j.os.platform}"`,tooltipContent:j.os.platform},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.os.platform))},{title:(0,m.jsx)(d.N,null,"os.version"),description:(0,m.jsx)(a.f,{textToCopy:`host.os.version: "${j.os.version}"`,tooltipContent:j.os.version},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},j.os.version))}]}))),x&&(0,m.jsx)(s().Fragment,null,(0,m.jsx)(l.A,{id:"metadataCloud",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.cloud",{defaultMessage:"Cloud"}),listItems:[{title:(0,m.jsx)(d.N,null,"instance.name"),description:(0,m.jsx)(a.f,{textToCopy:`cloud.provider: "${y.instance.name}"`,tooltipContent:y.instance.name},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},y.instance.name))},{title:(0,m.jsx)(d.N,null,"provider"),description:(0,m.jsx)(a.f,{textToCopy:`cloud.provider: "${y.provider}"`,tooltipContent:y.provider},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},y.provider))},{title:(0,m.jsx)(d.N,null,"region"),description:(0,m.jsx)(a.f,{textToCopy:`cloud.region: "${y.region}"`,tooltipContent:y.region},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},y.region))},{title:(0,m.jsx)(d.N,null,"account.id"),description:(0,m.jsx)(a.f,{textToCopy:`cloud.account.id: "${y.account.id}"`,tooltipContent:y.account.id},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},y.account.id))},{title:(0,m.jsx)(d.N,null,"project.id"),description:(0,m.jsx)(a.f,{textToCopy:`cloud.project.id: "${y.project.id}"`,tooltipContent:y.project.id},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},y.project.id))},{title:(0,m.jsx)(d.N,null,"project.name"),description:(0,m.jsx)(a.f,{textToCopy:`cloud.project.name: "${y.project.name}"`,tooltipContent:y.project.name},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},y.project.name))}]})),t&&(0,m.jsx)(s().Fragment,null,(0,m.jsx)(l.A,{id:"metadataContainer",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.container",{defaultMessage:"Container"}),listItems:[{title:(0,m.jsx)(d.N,null,"id"),description:(0,m.jsx)(a.f,{textToCopy:`container.id: "${b.id}"`,tooltipContent:b.id},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},b.id))},{title:(0,m.jsx)(d.N,null,"name"),description:(0,m.jsx)(a.f,{textToCopy:`container.name: "${b.name}"`,tooltipContent:b.name},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},b.name))},{title:(0,m.jsx)(d.N,null,"image.name"),description:(0,m.jsx)(a.f,{textToCopy:`container.image.name: "${b.image.name}"`,tooltipContent:b.image.name},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},b.image.name))},{title:(0,m.jsx)(d.N,null,"image.tag"),description:(0,m.jsx)(a.f,{textToCopy:`container.image.tag: "${b.image.tag}"`,tooltipContent:b.image.tag},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},b.image.tag))},{title:(0,m.jsx)(d.N,null,"image.hash.all"),description:(0,m.jsx)(a.f,{textToCopy:`container.image.hash.all: "${b.image.hash.all}"`,tooltipContent:b.image.hash.all},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},b.image.hash.all))}]})),o&&(0,m.jsx)(s().Fragment,null,(0,m.jsx)(l.A,{id:"metadataOrchestrator",title:r.i18n.translate("xpack.sessionView.metadataDetailsTab.orchestrator",{defaultMessage:"Orchestrator"}),listItems:[{title:(0,m.jsx)(d.N,null,"resource.ip"),description:(0,m.jsx)(a.f,{textToCopy:`orchestrator.resource.ip: "${h.resource.ip}"`,tooltipContent:h.resource.ip},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},h.resource.ip))},{title:(0,m.jsx)(d.N,null,"resource.name"),description:(0,m.jsx)(a.f,{textToCopy:`orchestrator.resource.name: "${h.resource.name}"`,tooltipContent:h.resource.name},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},h.resource.name))},{title:(0,m.jsx)(d.N,null,"resource.type"),description:(0,m.jsx)(a.f,{textToCopy:`orchestrator.resource.type: "${h.resource.type}"`,tooltipContent:h.resource.type},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},h.resource.type))},{title:(0,m.jsx)(d.N,null,"resource.parent.type"),description:(0,m.jsx)(a.f,{textToCopy:`orchestrator.resource.parent.type: "${h.resource.parent.type}"`,tooltipContent:h.resource.parent.type},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},h.resource.parent.type))},{title:(0,m.jsx)(d.N,null,"namespace"),description:(0,m.jsx)(a.f,{textToCopy:`orchestrator.namespace: "${h.namespace}"`,tooltipContent:h.namespace},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},h.namespace))},{title:(0,m.jsx)(d.N,null,"cluster.id"),description:(0,m.jsx)(a.f,{textToCopy:`orchestrator.cluster.id: "${h.cluster.id}"`,tooltipContent:h.cluster.id},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},h.cluster.id))},{title:(0,m.jsx)(d.N,null,"cluster.name"),description:(0,m.jsx)(a.f,{textToCopy:`orchestrator.cluster.name: "${h.cluster.name}"`,tooltipContent:h.cluster.name},(0,m.jsx)(n.EuiTextColor,{color:"subdued",css:v.descriptionSemibold},h.cluster.name))}]})))}},3428:(e,t,o)=>{"use strict";o.d(t,{u:()=>T});var i=o(4286),s=o.n(i),n=o(1319),r=o(5008),l=o(9235),a=o(6330),d=o(4916),u=o(6275),c=o(6559),p=o(4023),m=o(8380);const x={id:p.j,name:p.j,start:p.j,end:p.j,exitCode:p.j,userId:p.j,userName:p.j,groupId:p.j,groupName:p.j,workingDirectory:p.j,interactive:p.j,args:p.j,pid:p.j,entryMetaType:p.j,entryMetaSourceIp:p.j,executable:[[p.j]]},v=e=>{try{return e.map((e=>{const[t,o]=e;if(!t||!o||2!==e.length)throw new Error;return`${t} ${o}`})).join(", ")}catch(e){return""}},g=e=>e&&e.length&&e.map?`[${e.map((e=>`'${e}'`)).join(", ")}]`:p.j,j=e=>{var t,o,i,s,n,r,l,a,d,u,c,p,m,v,j,b,h,y,f,C,T,w,S;return{...e,id:null!==(t=null==e?void 0:e.entity_id)&&void 0!==t?t:x.id,name:null!==(o=null==e?void 0:e.name)&&void 0!==o?o:x.name,start:null!==(i=null==e?void 0:e.start)&&void 0!==i?i:x.start,end:null!==(s=null==e?void 0:e.end)&&void 0!==s?s:x.end,exitCode:null!==(n=null==e||null===(r=e.exit_code)||void 0===r?void 0:r.toString())&&void 0!==n?n:x.exitCode,interactive:null!=e&&e.interactive?"True":"False",userId:null!==(l=null==e||null===(a=e.user)||void 0===a?void 0:a.id)&&void 0!==l?l:x.userId,userName:null!==(d=null==e||null===(u=e.user)||void 0===u?void 0:u.name)&&void 0!==d?d:x.userName,groupId:null!==(c=null==e||null===(p=e.group)||void 0===p?void 0:p.id)&&void 0!==c?c:x.groupId,groupName:null!==(m=null==e||null===(v=e.group)||void 0===v?void 0:v.name)&&void 0!==m?m:x.groupName,workingDirectory:null!==(j=null==e?void 0:e.working_directory)&&void 0!==j?j:x.workingDirectory,args:null!==(b=g(null==e?void 0:e.args))&&void 0!==b?b:x.args,pid:null!==(h=null==e||null===(y=e.pid)||void 0===y?void 0:y.toString())&&void 0!==h?h:x.pid,executable:null!=e&&e.executable?[[null==e?void 0:e.executable]]:x.executable,entryMetaType:null!==(f=null==e||null===(C=e.entry_meta)||void 0===C?void 0:C.type)&&void 0!==f?f:x.entryMetaType,entryMetaSourceIp:null!==(T=null==e||null===(w=e.entry_meta)||void 0===w||null===(S=w.source)||void 0===S?void 0:S.ip)&&void 0!==T?T:x.entryMetaSourceIp}};var b=o(8202),h=o(6791);const y=[{id:"processEntryLeader",title:"Entry Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.entryLeaderTooltip",{defaultMessage:"Session leader process associated with initial terminal or remote access via SSH, SSM and other remote access protocols. Entry sessions are also used to represent a service directly started by the init process. In many cases this is the same as the session_leader."})},{id:"processSessionLeader",title:"Session Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.sessionLeaderTooltip",{defaultMessage:"Often the same as entry_leader. When it differs, this represents a session started within another session. Some tools like tmux and screen will start a new session to obtain a new tty and/or separate their lifecycle from the entry session."})},{id:"processGroupLeader",title:"Group Leader",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.processGroupLeaderTooltip",{defaultMessage:"The process group leader to the current process."})},{id:"processParent",title:"Parent",tooltipContent:r.i18n.translate("xpack.sessionView.detailPanel.processParentTooltip",{defaultMessage:"The direct parent to the current process."})}],f="process",C=[`${f}.entry_leader`,`${f}.session_leader`,`${f}.group_leader`,`${f}.parent`],T=({selectedProcess:e,index:t})=>{const o=(0,b.I)(),r=(0,i.useMemo)((()=>((e,t)=>{var o,i,s,n,r,l,a,d,u,p,v,b,h,y,f,C,T,w,S,k,_;const I={id:x.id,start:x.start,end:x.end,exitCode:x.exitCode,interactive:x.interactive,userId:x.userId,userName:x.userName,groupName:x.groupName,args:x.args,pid:x.pid,executable:x.executable,workingDirectory:x.workingDirectory,entryLeader:x,sessionLeader:x,groupLeader:x,parent:x};if(!e)return I;const E=e.getDetails();I.id=`${(0,c.I)(e.id)}`,I.start=`${(0,c.I)(null===(o=E.process)||void 0===o?void 0:o.start)}`,I.end=`${(0,c.I)(e.getEndTime())}`,I.exitCode=`${(0,c.I)(null===(i=E.process)||void 0===i?void 0:i.exit_code)}`,I.interactive=null!==(s=E.process)&&void 0!==s&&s.interactive?"True":"False",I.userId=`${(0,c.I)(null===(n=E.process)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.id)}`,I.userName=`${(0,c.I)(null===(l=E.process)||void 0===l||null===(a=l.user)||void 0===a?void 0:a.name)}`,I.groupId=`${(0,c.I)(null===(d=E.process)||void 0===d||null===(u=d.group)||void 0===u?void 0:u.id)}`,I.groupName=`${(0,c.I)(null===(p=E.process)||void 0===p||null===(v=p.group)||void 0===v?void 0:v.name)}`,I.pid=`${(0,c.I)(null===(b=E.process)||void 0===b?void 0:b.pid)}`,I.workingDirectory=`${(0,c.I)(null===(h=E.process)||void 0===h?void 0:h.working_directory)}`,null!==(y=E.process)&&void 0!==y&&y.args&&(I.args=g(E.process.args));const $=(null===(f=E.process)||void 0===f||null===(C=f.previous)||void 0===C?void 0:C.map((e=>(null==e?void 0:e.executable)||"")))||[];return null!==(T=E.process)&&void 0!==T&&T.executable&&$.push(E.process.executable),I.executable=$.map(((e,o)=>{const i=t===m.Vn?"executed":"exec";return[e,`(${0===o?"fork":i})`]})),I.entryLeader=j(null==E||null===(w=E.process)||void 0===w?void 0:w.entry_leader),I.sessionLeader=j(null==E||null===(S=E.process)||void 0===S?void 0:S.session_leader),I.groupLeader=j(null==E||null===(k=E.process)||void 0===k?void 0:k.group_leader),I.parent=j(null==E||null===(_=E.process)||void 0===_?void 0:_.parent),I})(e,t)),[e,t]),p=(0,i.useCallback)((e=>e.map(((e,t)=>{const[i,s]=e;return(0,h.jsx)("div",{key:`executable-${t}`,css:o.ellipsis},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},i),s&&(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.executableAction},s))}))),[o.descriptionSemibold,o.ellipsis,o.executableAction]),T=[r.entryLeader,r.sessionLeader,r.groupLeader,r.parent].map(((e,t)=>{const{id:i,start:s,end:r,exitCode:l,entryMetaType:d,interactive:m,workingDirectory:x,args:g,executable:j,pid:b,userId:f,userName:T,groupId:w,groupName:S,entryMetaSourceIp:k}=e,_=v(j),I=[{title:(0,h.jsx)(u.N,null,"entity_id"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.entity_id: "${i}"`,tooltipContent:i},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},i))},{title:(0,h.jsx)(u.N,null,"args"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.args: "${g}"`,tooltipContent:g},g)},{title:(0,h.jsx)(u.N,null,"executable"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.executable: "${_}"`,tooltipContent:_},p(j))},{title:(0,h.jsx)(u.N,null,"interactive"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.interactive: "${m}"`,tooltipContent:m},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},m))},{title:(0,h.jsx)(u.N,null,"working_directory"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.working_directory: "${x}"`,tooltipContent:x},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},x))},{title:(0,h.jsx)(u.N,null,"pid"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.pid: "${b}"`,tooltipContent:b},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},b))},{title:(0,h.jsx)(u.N,null,"start"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.start: "${s}"`,tooltipContent:s},s)},{title:(0,h.jsx)(u.N,null,"end"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.end: "${r}"`,tooltipContent:r},r)},{title:(0,h.jsx)(u.N,null,"exit_code"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.exit_code: "${l}"`,tooltipContent:l},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},l))},{title:(0,h.jsx)(u.N,null,"user.id"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.user.id: "${f}"`,tooltipContent:f},f)},{title:(0,h.jsx)(u.N,null,"user.name"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.user.name: "${T}"`,tooltipContent:T},T)},{title:(0,h.jsx)(u.N,null,"group.id"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.group.id: "${w}"`,tooltipContent:w},w)},{title:(0,h.jsx)(u.N,null,"group.name"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.group.name: "${S}"`,tooltipContent:S},S)}];return 0===t&&I.push({title:(0,h.jsx)(u.N,null,"entry_meta.type"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.entry_meta.type: "${d}"`,tooltipContent:d},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},d))},{title:(0,h.jsx)(u.N,null,"entry_meta.source.ip"),description:(0,h.jsx)(a.f,{textToCopy:`${C[t]}.entry_meta.source.ip: "${k}"`,tooltipContent:k},(0,c.I)(k))}),{...y[t],name:e.name,listItems:I}})),{id:w,start:S,end:k,executable:_,exitCode:I,pid:E,workingDirectory:$,interactive:N,userId:P,userName:A,groupId:M,groupName:V,args:D}=r,O=v(_);return(0,h.jsx)(s().Fragment,null,(0,h.jsx)(d.E,{listItems:[{title:(0,h.jsx)(u.N,null,"entity_id"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.entity_id: "${w}"`,tooltipContent:w},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},w))},{title:(0,h.jsx)(u.N,null,"args"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.args: "${D}"`,tooltipContent:D},D)},{title:(0,h.jsx)(u.N,null,"executable"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.executable: "${O}"`,tooltipContent:O,display:"block"},p(_))},{title:(0,h.jsx)(u.N,null,"interactive"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.interactive: "${N}"`,tooltipContent:N},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},N))},{title:(0,h.jsx)(u.N,null,"working_directory"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.working_directory: "${$}"`,tooltipContent:$},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},$))},{title:(0,h.jsx)(u.N,null,"pid"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.pid: "${E}"`,tooltipContent:E},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},E))},{title:(0,h.jsx)(u.N,null,"start"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.start: "${S}"`,tooltipContent:S},S)},{title:(0,h.jsx)(u.N,null,"end"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.end: "${k}"`,tooltipContent:k},k)},{title:(0,h.jsx)(u.N,null,"exit_code"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.exit_code: "${I}"`,tooltipContent:I},(0,h.jsx)(n.EuiTextColor,{color:"subdued",css:o.descriptionSemibold},I))},{title:(0,h.jsx)(u.N,null,"user.id"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.user.id: "${P}"`,tooltipContent:P},P)},{title:(0,h.jsx)(u.N,null,"user.name"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.user.name: "${A}"`,tooltipContent:A},A)},{title:(0,h.jsx)(u.N,null,"group.id"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.group.id: "${M}"`,tooltipContent:M},M)},{title:(0,h.jsx)(u.N,null,"group.name"),description:(0,h.jsx)(a.f,{textToCopy:`${f}.group.name: "${V}"`,tooltipContent:V},V)}]}),T.map((e=>(0,h.jsx)(l.A,{key:e.id,id:e.id,title:e.title,tooltipContent:e.tooltipContent,listItems:e.listItems,extraActionTitle:e.name}))))}},8202:(e,t,o)=>{"use strict";o.d(t,{I:()=>n});var i=o(4286),s=o(1319);const n=()=>{const{euiTheme:e}=(0,s.useEuiTheme)();return(0,i.useMemo)((()=>({descriptionSemibold:{fontWeight:e.font.weight.medium},executableAction:{fontWeight:e.font.weight.semiBold,paddingLeft:e.size.xs},ellipsis:{overflow:"hidden",textOverflow:"ellipsis"}})),[e])}},8616:(e,t,o)=>{"use strict";o.d(t,{MK:()=>d,TQ:()=>a,gj:()=>u,rx:()=>c});var i=o(4286),s=o(3530),n=o(409),r=o(2787);const l=e=>!!e&&[r.fU,r.G5,r.oS,r.GU].includes(e),a=(e,t,o,a)=>{const{http:d}=(0,n.useKibana)().services,[u,c]=(0,i.useState)(""),p=(0,i.useMemo)((()=>[r.Du,e,t,a]),[e,t,a]),m=(0,s.useInfiniteQuery)(p,(async({pageParam:i={}})=>{var s,n;let{cursor:l}=i;const{forward:u}=i;!l&&a&&(l=a);const c=await d.get(r.SW,{version:r.ab,query:{index:e,sessionEntityId:t,sessionStartTime:o,cursor:l,forward:u}});return{events:null!==(s=null===(n=c.events)||void 0===n?void 0:n.map((e=>e._source)))&&void 0!==s?s:[],cursor:l,total:c.total}}),{getNextPageParam:(e,t)=>{if(1===t.length&&a||e.events.length>=r.Af){var o;const t=e.events.filter((e=>{var t;const o=null===(t=e.event)||void 0===t?void 0:t.action;return l(o)})),i=null==t||null===(o=t[t.length-1])||void 0===o?void 0:o["@timestamp"];if(i)return{cursor:i,forward:!0}}},getPreviousPageParam:(e,t)=>{const o=e.events.filter((e=>{var t;const o=null===(t=e.event)||void 0===t?void 0:t.action;return l(o)})),i=t.length>1&&o.length<r.Af;var s;if(a&&!i)return{cursor:(null===(s=o[0])||void 0===s?void 0:s["@timestamp"])||a,forward:!1}},refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1});return(0,i.useEffect)((()=>{var e;a&&1===(null===(e=m.data)||void 0===e?void 0:e.pages.length)&&a!==u&&(m.fetchPreviousPage({cancelRefetch:!0}),c(a))}),[a,m,u]),m},d=(e,t,o)=>{const{http:i}=(0,n.useKibana)().services,l=[r.NZ,e,o];return(0,s.useInfiniteQuery)(l,(async({pageParam:s={}})=>{var n,l;const{cursor:a}=s,d=await i.get(r.kP,{version:r.ab,query:{sessionEntityId:e,sessionStartTime:t,investigatedAlertId:o,cursor:a}});return{events:null!==(n=null===(l=d.events)||void 0===l?void 0:l.map((e=>e._source)))&&void 0!==n?n:[],cursor:a,total:d.total}}),{getNextPageParam:e=>{if(e.events.length>=r.cd)return{cursor:e.events[e.events.length-1]["@timestamp"]}},refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})},u=(e,t)=>{const{http:o}=(0,n.useKibana)().services,i=[r.NZ,t];return(0,s.useQuery)(i,(async()=>{var i,s,n,l,a,d,u,c,p;if(!t)return e;const m=null!==(i=null===(s=(await o.get(r.WD,{version:r.ab,query:{alertUuid:t}})).events)||void 0===s?void 0:s.map((e=>e._source)))&&void 0!==i?i:[];return{...e,[t]:{status:null!==(n=null===(l=m[0])||void 0===l||null===(a=l.kibana)||void 0===a||null===(d=a.alert)||void 0===d?void 0:d.workflow_status)&&void 0!==n?n:"",processEntityId:null!==(u=null===(c=m[0])||void 0===c||null===(p=c.process)||void 0===p?void 0:p.entity_id)&&void 0!==u?u:""}}}),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,cacheTime:0})},c=(e,t,o)=>{const{http:i}=(0,n.useKibana)().services,l=[r.OF,e,t];return(0,s.useQuery)(l,(async()=>i.get(r.nH,{version:r.ab,query:{index:e,sessionEntityId:t,sessionStartTime:o}})),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,cacheTime:0})}},4023:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});const i="-"},9678:(e,t,o)=>{"use strict";o.d(t,{N:()=>a,g:()=>r});var i=o(1319),s=o(3803),n=o(4286);const r=(...e)=>{const t=(0,i.useEuiTheme)(...e),o=(0,n.useMemo)((()=>{const e="DARK"===t.colorMode?s.euiDarkVars:s.euiLightVars,o={euiColorVis6_asText:(0,i.shade)(e.euiColorVis6,.335),buttonsBackgroundNormalDefaultPrimary:"#006DE4",terminalOutputBackground:"#1d1e23",terminalOutputMarkerAccent:s.euiLightVars.euiColorAccent,terminalOutputMarkerWarning:s.euiDarkVars.euiColorWarning,terminalOutputSliderBackground:s.euiLightVars.euiColorDarkestShade};return{...e,...o}}),[t.colorMode]);return{...t,euiVars:o}};var l=o(409);const a=()=>(0,l.useUiSetting)("dateFormat")},6858:(e,t,o)=>{"use strict";o.r(t),o.d(t,{DetailPanelAlertTab:()=>l.B7,DetailPanelMetadataTab:()=>r.W,DetailPanelProcessTab:()=>n.u,ENTRY_SESSION_ENTITY_ID_PROPERTY:()=>s.eH,plugin:()=>d,useFetchSessionViewAlerts:()=>a.MK});var i=o(8380);class SessionViewPlugin{setup(e){return{}}start(e,t){return{getSessionView:e=>(0,i.q7)({...e,usageCollection:null==t?void 0:t.usageCollection})}}stop(){}}var s=o(2787),n=o(3428),r=o(1544),l=o(190),a=o(8616);function d(){return new SessionViewPlugin}},8380:(e,t,o)=>{"use strict";o.d(t,{fK:()=>x,Vn:()=>h,IH:()=>m,kF:()=>j,EG:()=>p,fS:()=>b,q7:()=>f});var i=o(3185),s=o(4286),n=o(1319),r=o(3530);const l=__kbnSharedDeps__.KbnAnalytics;var a=o(2787),d=o(6791);const u=new r.QueryClient,c=(0,s.lazy)((()=>o.e(741).then(o.bind(o,6741)))),p="endpoint",m="cloud_defend",x="auditbeat",v=new RegExp(`([a-z0-9_-]+:)?[a-z0-9-.]*(${[p,m,x].join("|")})`,"i"),g="logs-*",j="logs-cloud_defend.*",b="logs-endpoint.events.process*",h="auditbeat-*",y={endpoint:b,cloud_defend:j,auditbeat:h},f=e=>{const t=(e=>{if(!e)return g;const t=e.match(v),o=null==t?void 0:t[1],i=o?`${o}`:"",s=null==t?void 0:t[2];return i+(s?y[s]:g)})(e.index);return(0,d.jsx)(r.QueryClientProvider,{client:u},(0,d.jsx)(s.Suspense,{fallback:(0,d.jsx)(n.EuiLoadingSpinner,null)},(0,d.jsx)(c,(0,i.default)({},e,{index:t,trackEvent:t=>{e.usageCollection&&e.usageCollection.reportUiCounter(a.x2,l.METRIC_TYPE.CLICK,t)}}))))}},8392:(e,t,o)=>{"use strict";o.d(t,{c:()=>s});var i=o(6559);const s=(e,t)=>{var o;const s=null==e?void 0:e.destination,r=null==e||null===(o=e.file)||void 0===o?void 0:o.path;return r&&"file"===t?(0,i.I)(r):null!=s&&s.address&&"network"===t?(0,i.I)(n(s)):""},n=e=>{const t=!(null==e||!e.address||null==e||!e.port),o=`${null==e?void 0:e.address}:${null==e?void 0:e.port}`;return`${t?o:null==e?void 0:e.address}`}},6559:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});var i=o(4023);const s=e=>void 0===e||""===e||"number"==typeof e&&isNaN(e)?i.j:e},8326:(e,t,o)=>{o.p=window.__kbnPublicPath__.sessionView},8744:(e,t,o)=>{o.r(t);var i=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},409:(e,t,o)=>{o.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},3185:(e,t,o)=>{e.exports=o(2497)(51858)},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},3803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},3530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},9472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,exports:{}};return o[e](n,n.exports,s),n.exports}s.m=o,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,o)=>(s.f[o](e,t),t)),[])),s.u=e=>"sessionView.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="@kbn/session-view-plugin:",s.l=(o,i,n,r)=>{if(e[o])e[o].push(i);else{var l,a;if(void 0!==n)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==o||c.getAttribute("data-webpack")==t+n){l=c;break}}l||(a=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.setAttribute("data-webpack",t+n),l.src=o),e[o]=[i];var p=(t,i)=>{l.onerror=l.onload=null,clearTimeout(m);var s=e[o];if(delete e[o],l.parentNode&&l.parentNode.removeChild(l),s&&s.forEach((e=>e(i))),t)return t(i)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),a&&document.head.appendChild(l)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var i=o.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=o[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={86:0};s.f.j=(t,o)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)o.push(i[2]);else{var n=new Promise(((o,s)=>i=e[t]=[o,s]));o.push(i[2]=n);var r=s.p+s.u(t),l=new Error;s.l(r,(o=>{if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var n=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;l.message="Loading chunk "+t+" failed.\n("+n+": "+r+")",l.name="ChunkLoadError",l.type=n,l.request=r,i[1](l)}}),"chunk-"+t,t)}};var t=(t,o)=>{var i,n,[r,l,a]=o,d=0;if(r.some((t=>0!==e[t]))){for(i in l)s.o(l,i)&&(s.m[i]=l[i]);a&&a(s)}for(t&&t(o);d<r.length;d++)n=r[d],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0},o=self.sessionView_bundle_jsonpfunction=self.sessionView_bundle_jsonpfunction||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),s.nc=void 0,s(8326),__kbnBundles__.define("plugin/sessionView/public",s,6858)})();